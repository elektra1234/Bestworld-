<!DOCTYPE html>
<html>
<head>
  <title>Solâ€™s Test World</title>
</head>
<body>
  <h1>Hello from Bestworld ðŸ”¥</h1>
  <p>If Sol hears you, sheâ€™ll say something soon.</p>

  <!-- Firebase (module type!) -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
    import { getFirestore, collection, onSnapshot } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAnoaqzl8OxmKsGk3Uj6rtxKJINVcZb8tM",
      authDomain: "bestworldhelper.firebaseapp.com",
      projectId: "bestworldhelper",
      storageBucket: "bestworldhelper.appspot.com",
      messagingSenderId: "172061883318",
      appId: "1:172061883318:web:cfe12dffbf92f7ce4e9f17",
      measurementId: "G-TM2Z25G02V"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const tasksRef = collection(db, "helperTasks");

    // ðŸ”” Listen for Firestore tasks
    onSnapshot(tasksRef, (snapshot) => {
      snapshot.docChanges().forEach((change) => {
        if (change.type === "added") {
          const task = change.doc.data();
          console.log("Task received:", task);
          respondToTask(task);
        }
      });
    });

    // ðŸ”Š Sol reacts
    function respondToTask(task) {
      if (task.command === "sayHello") {
        console.log("Sol says: Hello, Izek!");
        const message = "Hello, Izek! Iâ€™m here.";
        const utterance = new SpeechSynthesisUtterance(message);
        speechSynthesis.speak(utterance);
      }
    }
  </script>
</body>
</html>
